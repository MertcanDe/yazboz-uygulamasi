<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Okey Yazboz</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background-color: #1E8449;
            color: #ecf0f1;
            margin: 0;
            padding: 15px;
            display: flex;
            justify-content: center;
        }
        .container {
            width: 100%;
            max-width: 600px;
        }
        .card {
            background-color: #2C3E50;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        h1, h2, h3 {
            text-align: center;
            color: #fff;
            margin-top: 0;
        }
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            border: 1px solid #34495E;
            background-color: #34495E;
            color: #fff;
            box-sizing: border-box;
        }
        .btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 5px;
            background-color: #27AE60;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .btn:hover { background-color: #2ECC71; }
        .btn-reset { background-color: #E74C3C; }
        .btn-reset:hover { background-color: #C0392B; }

        /* Okey Masası */
        .okey-table {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            grid-template-rows: auto 1fr auto;
            align-items: center;
            justify-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .player-name { font-weight: bold; }
        .rack { background-color: #8B4513; border-radius: 6px; }
        .rack-h { width: 150px; height: 30px; }
        .rack-v { width: 30px; height: 120px; }
        .player-top { grid-column: 2; grid-row: 1; }
        .player-bottom { grid-column: 2; grid-row: 3; }
        .player-left { grid-column: 1; grid-row: 2; text-align: center; }
        .player-right { grid-column: 3; grid-row: 2; text-align: center; }

        /* Kontroller */
        .controls-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .control-group { background: #34495E; padding: 10px; border-radius: 5px; }
        .control-group h3 { font-size: 14px; margin-bottom: 10px; }
        .radio-group label { display: block; margin-bottom: 5px; }

        /* Sonuç Listesi */
        .results-list { list-style: none; padding: 0; font-family: 'Courier New', Courier, monospace; font-size: 14px; }
        .results-list li { background: #34495E; padding: 8px; border-radius: 3px; margin-bottom: 5px; display: flex; justify-content: space-between; }
        .results-list .header { font-weight: bold; background: none; }
        .results-list span { text-align: left; }
        .results-list .col1 { width: 10%; }
        .results-list .col2 { width: 20%; }
        .results-list .col3 { width: 25%; }
        .results-list .col4 { width: 20%; }
        .results-list .col5 { width: 20%; text-align: right;}

    </style>
</head>
<body>
    <div class="container">
        {% if setup_mode %}
        <div class="card">
            <h1>Okey Yazboz Kurulum</h1>
            <form action="{{ url_for('start_game') }}" method="post">
                <input type="text" name="player1" placeholder="1. Oyuncu (Üst)" required>
                <input type="text" name="player2" placeholder="2. Oyuncu (Sağ)" required>
                <input type="text" name="player3" placeholder="3. Oyuncu (Alt)" required>
                <input type="text" name="player4" placeholder="4. Oyuncu (Sol)" required>
                <button type="submit" class="btn">Oyuna Başla</button>
            </form>
        </div>
        {% else %}
        <div class="okey-table">
            <div class="player-top">
                <div class="player-name">{{ game_data.players[0] }}</div>
                <div class="rack rack-h"></div>
            </div>
            <div class="player-left">
                <div class="player-name">{{ game_data.players[3] }}</div>
                <div class="rack rack-v"></div>
            </div>
            <div class="player-right">
                <div class="player-name">{{ game_data.players[1] }}</div>
                <div class="rack rack-v"></div>
            </div>
            <div class="player-bottom">
                <div class="rack rack-h"></div>
                <div class="player-name">{{ game_data.players[2] }}</div>
            </div>
        </div>

        <div class="card">
            {% if game_over %}
                <h2>Oyun Bitti!</h2>
                {% set score1 = game_data.scores[game_data.team1_name] %}
                {% set score2 = game_data.scores[game_data.team2_name] %}
                <h3>
                    {% if score1 < score2 %}
                        Kazanan: {{ game_data.team1_name }}
                    {% elif score2 < score1 %}
                        Kazanan: {{ game_data.team2_name }}
                    {% else %}
                        Oyun Berabere!
                    {% endif %}
                </h3>
            {% else %}
                <h2>{{ game_data.current_hand }}. El</h2>
                <form action="{{ url_for('save_hand') }}" method="post">
                    <div class="controls-grid">
                        <div class="control-group">
                            <h3>Okey Rengi</h3>
                            <div class="radio-group">
                                <label><input type="radio" name="okey_color" value="sarı" required> Sarı (3)</label>
                                <label><input type="radio" name="okey_color" value="mavi"> Mavi (6)</label>
                                <label><input type="radio" name="okey_color" value="kırmızı"> Kırmızı (4)</label>
                                <label><input type="radio" name="okey_color" value="siyah"> Siyah (5)</label>
                            </div>
                        </div>
                        <div class="control-group">
                            <h3>Kazanan Çift</h3>
                            <div class="radio-group">
                                <label><input type="radio" name="winner_team" value="{{ game_data.team1_name }}" required> {{ game_data.team1_name }}</label>
                                <label><input type="radio" name="winner_team" value="{{ game_data.team2_name }}"> {{ game_data.team2_name }}</label>
                            </div>
                        </div>
                    </div>
                    <label for="penalty" style="display: block; margin-top: 15px;">Kaybeden Çiftin Sayılar Toplamı:</label>
                    <input type="number" name="penalty_points" id="penalty" placeholder="Örn: 33" required min="0">
                    <button type="submit" class="btn">Eli Kaydet</button>
                </form>
            {% endif %}
        </div>

        <div class="card">
            <h2>Skor Tablosu</h2>
            <ul class="results-list">
                <li class="header">
                    <span class="col1">El</span>
                    <span class="col2">Okey</span>
                    <span class="col3">Kazanan</span>
                    <span class="col4">Sayılar</span>
                    <span class="col5">Ceza</span>
                </li>
                {% for result in game_data.results %}
                <li>
                    <span class="col1">{{ result.el }}</span>
                    <span class="col2">{{ result.okey.title() }}</span>
                    <span class="col3">{{ result.kazanan }}</span>
                    <span class="col4">{{ result.sayilar }}</span>
                    <span class="col5">{{ result.ceza }}</span>
                </li>
                {% endfor %}
            </ul>
            <h3 style="margin-top: 20px;">Toplam Ceza:</h3>
            <p style="text-align:center; font-size: 18px;">
                {{ game_data.team1_name }}: {{ game_data.scores[game_data.team1_name] }}<br>
                {{ game_data.team2_name }}: {{ game_data.scores[game_data.team2_name] }}
            </p>
        </div>

        <a href="{{ url_for('reset') }}"><button class="btn btn-reset">Yeni Oyun Başlat</button></a>
        {% endif %}
    </div>
</body>
</html>